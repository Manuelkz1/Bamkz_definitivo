import{c as M,u as $,r as m,s as L,a as D,j as e,L as o,A as u,P as h,f as v,g as P}from"./index-Bh9ycJS2.js";import{C as I}from"./chevron-right-DSRHM6qT.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=M("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);function T(){const{user:g}=$(),[f,w]=m.useState([]),[_,j]=m.useState(!0),[y,N]=m.useState(null);m.useEffect(()=>{k()},[g]);const k=async()=>{if(g)try{j(!0),N(null);const{data:s,error:a}=await L.from("orders").select(`
          *,
          order_items (
            quantity,
            price_at_time,
            selected_color,
            products (
              name,
              images,
              shipping_days,
              description
            )
          )
        `).eq("user_id",g.id).neq("status","payment_pending").neq("payment_status","awaiting_payment").order("created_at",{ascending:!1});if(a)throw a;w(s||[])}catch(s){console.error("Error loading orders:",s),N("Error al cargar los pedidos"),D.error("Error al cargar los pedidos")}finally{j(!1)}},E=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=s=>({pending:"Pendiente",processing:"Procesando",shipped:"Enviado",delivered:"Entregado",cancelled:"Cancelado"})[s]||s,q=s=>{if(s.shipping_days)return s.shipping_days;if(s.description){const a=s.description.match(/\[shipping_days:(\d+)\]/);if(a&&a[1])return a[1]}return"3-5"},C=s=>{if(!s.order_items||s.order_items.length===0)return"3-5";const a=s.order_items.map(i=>q(i.products)),r=Math.max(...a.map(i=>{if(i.includes("-")){const c=i.split("-");return parseInt(c[1],10)||parseInt(c[0],10)}return parseInt(i,10)||5})),n=[...new Set(a)];return n.length===1?n[0]:`${Math.max(3,r-2)}-${r}`},p=(s,a="Sin imagen")=>{const r=s.target;r.src=`https://via.placeholder.com/400x300/f3f4f6/9ca3af?text=${encodeURIComponent(a)}`},b=s=>s.order_items?s.order_items.reduce((a,r)=>a+r.quantity,0):0;return _?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs(o,{to:"/\\",className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"Volver"]})}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})})]})}):y?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs(o,{to:"/",className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"Volver"]})}),e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:y})})]})})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs(o,{to:"/",className:"flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"Volver"]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-6 border-b border-gray-200 bg-gradient-to-r from-indigo-500 to-purple-600",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(h,{className:"h-8 w-8 text-white"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Mis Pedidos"}),e.jsx("p",{className:"text-indigo-100 text-sm",children:"Historial completo de tus compras"})]})]})}),f.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(h,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay pedidos aún"}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:"Descubre nuestros productos y realiza tu primera compra. ¡Tenemos ofertas increíbles esperándote!"}),e.jsxs(o,{to:"/",className:"inline-flex items-center px-6 py-3 border border-transparent shadow-sm text-base font-medium rounded-lg text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200",children:[e.jsx(h,{className:"h-5 w-5 mr-2"}),"Explorar productos"]})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:f.map((s,a)=>{var r,n,i,c;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:e.jsx(o,{to:`/orders/${s.id}`,className:"block",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Pedido ",a+1]}),e.jsxs("span",{className:"text-sm text-gray-500 font-mono bg-gray-100 px-2 py-1 rounded",children:["#",(r=s.id)==null?void 0:r.substring(0,8)]}),e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:[b(s)," producto",b(s)!==1?"s":""]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${E(s.status)}`,children:S(s.status)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Fecha del pedido"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v(new Date(s.created_at),"dd/MM/yyyy")}),e.jsx("p",{className:"text-xs text-gray-500",children:v(new Date(s.created_at),"HH:mm")})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Tiempo de entrega"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[C(s)," días hábiles estimados"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Desde la confirmación"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-4 w-4 bg-indigo-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-white font-bold",children:"$"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total pagado"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["$",s.total.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Productos incluidos"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[(n=s.order_items)==null?void 0:n.length," producto",((i=s.order_items)==null?void 0:i.length)!==1?"s":""]})]}),s.order_items&&s.order_items.length>1?e.jsxs("div",{className:`grid gap-3 ${s.order_items.length===2?"grid-cols-1 sm:grid-cols-2":s.order_items.length===3?"grid-cols-1 sm:grid-cols-3":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"}`,children:[s.order_items.slice(0,6).map((t,d)=>{var l;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:((l=t.products.images)==null?void 0:l[0])||"https://via.placeholder.com/64x64/f3f4f6/9ca3af?text=Sin+imagen",alt:t.products.name,className:"w-full h-full object-cover",onError:x=>p(x,"Sin imagen")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:t.products.name}),t.selected_color&&e.jsx("span",{className:"inline-block mt-1 text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:t.selected_color}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Cant: ",t.quantity]}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["$",(t.price_at_time*t.quantity).toFixed(2)]})]})]})]})},d)}),s.order_items.length>6&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center mb-2",children:e.jsx(h,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["+",s.order_items.length-6," productos más"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ver detalles completos"})]})})]}):(c=s.order_items)==null?void 0:c.map((t,d)=>{var l;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-20 h-20 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:((l=t.products.images)==null?void 0:l[0])||"https://via.placeholder.com/80x80/f3f4f6/9ca3af?text=Sin+imagen",alt:t.products.name,className:"w-full h-full object-cover hover:scale-105 transition-transform",onError:x=>p(x,"Sin imagen")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-2",children:t.products.name}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[t.selected_color&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Color:"}),e.jsx("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full",children:t.selected_color})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Cantidad:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.quantity})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["$",t.price_at_time.toFixed(2)," c/u"]}),e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:["$",(t.price_at_time*t.quantity).toFixed(2)]})]})]})]})},d)}),s.order_items&&s.order_items.length>1&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Vista previa del pedido"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.order_items.slice(0,4).map((t,d)=>{var l;return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded border-2 border-white shadow-sm overflow-hidden",children:e.jsx("img",{src:((l=t.products.images)==null?void 0:l[0])||"https://via.placeholder.com/40x40/f3f4f6/9ca3af?text=?",alt:t.products.name,className:"w-full h-full object-cover",onError:x=>p(x,"?")})}),t.quantity>1&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-indigo-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:t.quantity})]},d)}),s.order_items.length>4&&e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded border-2 border-white shadow-sm flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:["+",s.order_items.length-4]})})]})]})]})]}),e.jsx("div",{className:"ml-6 flex-shrink-0 self-center",children:e.jsx(I,{className:"h-6 w-6 text-gray-400"})})]})})},s.id)})})]})]})})}export{T as default};
